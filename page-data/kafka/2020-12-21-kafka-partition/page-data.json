{"componentChunkName":"component---src-templates-blog-template-js","path":"/kafka/2020-12-21-kafka-partition/","result":{"data":{"cur":{"id":"3df644f1-560a-5b03-9d0e-d2517a5b5822","html":"<h1 id=\"카프카-파티션\" style=\"position:relative;\"><a href=\"#%EC%B9%B4%ED%94%84%EC%B9%B4-%ED%8C%8C%ED%8B%B0%EC%85%98\" aria-label=\"카프카 파티션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>카프카 파티션?</h1>\n<p>카프카는 초당 수백만개의 메시지를 전송하고 처리를 제공하는 분산 스트리밍 플랫폼입니다.<br>\n처리성능을 높이기 위해 토픽 저장을 병렬화 할 수 있습니다.<br>\n그러한 방법은 브로커에 파티션을 나누는 것입니다.<br>\n하지만, 파티션은 늘리는것은 가능하지만 줄이는 것은 안되기 때문에 주의 해야합니다.<br>\n파티션 줄이고 싶다면 토픽을 삭제밖에 방법이 없습니다.<br>\nex)<br>\n1개의 파티션이 1분에 10개의 메시지를 받을 수 경우를 가정해보겠습니다.<br>\n프로듀서에서 1분에 50개의 메세지를 보낸다면,<br>\n토픽의 파티션을 5개로 늘려 처리 성능을 높여서 병목현상을 막을수 있을것입니다.</p>\n<h2 id=\"커맨드로-따라-해보기\" style=\"position:relative;\"><a href=\"#%EC%BB%A4%EB%A7%A8%EB%93%9C%EB%A1%9C-%EB%94%B0%EB%9D%BC-%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"커맨드로 따라 해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>커맨드로 따라 해보기</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 주키퍼 실행</span>\n$ bin/zookeeper-server-start.sh config/zookeeper.properties\n\n<span class=\"token comment\"># 카프카 실행 </span>\n$ bin/kafka-server-start.sh config/server.properties\n\n<span class=\"token comment\"># 생성된 토픽 리스트 가져오기</span>\n$ bin/kafka-topics.sh <span class=\"token parameter variable\">--zookeeper</span> localhost:2181 <span class=\"token parameter variable\">--list</span>\n<span class=\"token operator\">></span> __consumer_offsets\n\n<span class=\"token comment\"># 파티션 3개 토픽 생성하기</span>\n$ bin/kafka-topics.sh <span class=\"token parameter variable\">--zookeeper</span> localhost:2181 <span class=\"token parameter variable\">--topic</span> partition-first-topic <span class=\"token parameter variable\">--create</span> <span class=\"token parameter variable\">--partitions</span> <span class=\"token number\">3</span> --replication-factor <span class=\"token number\">1</span>\n<span class=\"token operator\">></span> Created topic partition-first-topic.\n\n<span class=\"token comment\"># 다시 토픽 리스트 확인하기</span>\n$ bin/kafka-topics.sh <span class=\"token parameter variable\">--zookeeper</span> localhost:2181 <span class=\"token parameter variable\">--list</span>\n<span class=\"token operator\">></span> __consumer_offsets\n<span class=\"token operator\">></span> partition-first-topic <span class=\"token comment\">## 토픽이 생성된것을 확인하실 수 있습니다.</span>\n\n<span class=\"token comment\"># 토픽 기본정보 확인하기</span>\n$ bin/kafka-topics.sh <span class=\"token parameter variable\">--zookeeper</span> localhost:2181 <span class=\"token parameter variable\">--describe</span> <span class=\"token parameter variable\">--topic</span> partition-first-topic\n<span class=\"token operator\">></span> Topic: partition-first-topic\tPartitionCount: <span class=\"token number\">3</span>\tReplicationFactor: <span class=\"token number\">1</span>\tConfigs:\n    Topic: partition-first-topic\tPartition: <span class=\"token number\">0</span>\tLeader: <span class=\"token number\">0</span>\tReplicas: <span class=\"token number\">0</span>\tIsr: <span class=\"token number\">0</span>\n    Topic: partition-first-topic\tPartition: <span class=\"token number\">1</span>\tLeader: <span class=\"token number\">0</span>\tReplicas: <span class=\"token number\">0</span>\tIsr: <span class=\"token number\">0</span>\n    Topic: partition-first-topic\tPartition: <span class=\"token number\">2</span>\tLeader: <span class=\"token number\">0</span>\tReplicas: <span class=\"token number\">0</span>\tIsr: <span class=\"token number\">0</span>\n<span class=\"token operator\">=</span><span class=\"token operator\">></span> 파티션 <span class=\"token number\">3</span>개가 생성된것을 확인할 수 있습니다.\n   ReplicationFactor는 토픽을 복제할 브로커 수입니다. 현재는 브로커 <span class=\"token number\">1</span>개로만 테스트 하고 있으므로 <span class=\"token string\">\"1\"</span>입니다.\n   \n<span class=\"token comment\"># 이제 토픽을 넣어 보겠습니다.</span>\n<span class=\"token comment\"># 파티션이 3개이니 3개로 분산해서 저장되는것을 예상하고 진행해보겠습니다.</span>\n<span class=\"token comment\"># 토픽 전송</span>\n$ bin/kafka-console-producer.sh <span class=\"token parameter variable\">--topic</span> partition-first-topic --bootstrap-server localhost:9092\n<span class=\"token operator\">></span>send 01\n<span class=\"token operator\">></span>send 02\n<span class=\"token operator\">></span>send 03\n<span class=\"token operator\">></span>send 04\n<span class=\"token operator\">></span>send 05\n\n<span class=\"token comment\"># 5개 메시지를 전송 하였습니다.</span>\n\n<span class=\"token comment\"># 컨슈머로 토픽을 받아 보겠습니다. (\"--property print.partition=true\" 추가하여 파티션을 출력합니다) </span>\n$ bin/kafka-console-consumer.sh <span class=\"token parameter variable\">--topic</span> partition-first-topic --from-beginning <span class=\"token parameter variable\">--property</span> <span class=\"token assign-left variable\">print.partition</span><span class=\"token operator\">=</span>true --bootstrap-server localhost:9092\n<span class=\"token operator\">></span> Partition:1\tsend 01\n<span class=\"token operator\">></span> Partition:1\tsend 03\n<span class=\"token operator\">></span> Partition:1\tsend 05\n<span class=\"token operator\">></span> Partition:2\tsend 04\n<span class=\"token operator\">></span> Partition:0\tsend 02\n\n<span class=\"token comment\"># 보시면 아시겠지만 파티션 0,1,2로 분산되어 저장된것을 확인하실 수 있습니다.</span>\n<span class=\"token comment\"># 눈에 띄는것이, 토픽을 가져올때는 순서대로 가져오지 않는다는걸 확인 할 수 있습니다.</span></code></pre></div>\n<h1 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h1>\n<ol>\n<li>토픽에 파티션을 추가하여 토픽을 생성해보았습니다.</li>\n<li>토픽 전송 후 파티션을 확인하였을때 분산되어 저장되는것을 확인 할 수 있었습니다.</li>\n<li>토픽을 가져올때는 순서대로 가져오지 않는다는걸 확인 하였습니다.</li>\n</ol>","excerpt":"카프카 파티션? 카프카는 초당 수백만개의 메시지를 전송하고 처리를 제공하는 분산 스트리밍 플랫폼입니다. 처리성능을 높이기 위해 토픽 저장을 병렬화 할 수 있습니다. 그러한 방법은 브로커에 파티션을 나누는 것입니다. 하지만, 파티션은 늘리는것은 가능하지만 줄이는 것은 안되기 때문에 주의 해야합니다. 파티션 줄이고 싶다면 토픽을 삭제밖에 방법이 없습니다. ex) 1개의 파티션이 1분에 10개의 메시지를 받을 수 경우를 가정해보겠습니다. 프로듀서에서 1분에 50개의 메세지를 보낸다면, 토픽의 파티션을 5개로 늘려 처리 성능을 높여서 병목현상을 막을수 있을것입니다. 커맨드로 따라 해보기 마무리 토픽에 파티션을 추가하여 토픽을 생성해보았습니다. 토픽 전송 후 파티션을 확인하였을때 분산되어 저장되는것을 확인 할 수 있었습니다. 토픽을 가져올때는 순서대로 가져오지 않는다는걸 확인 하였습니다.","frontmatter":{"date":"December 21, 2020","title":"도대체 카프카 토픽 파티션?","categories":"kafka","author":"wooobo","emoji":"🔮"},"fields":{"slug":"/kafka/2020-12-21-kafka-partition/"}},"next":{"id":"01a6733d-4681-543d-8456-fcd260dad5ee","html":"<h2 id=\"카프카를-알게-된-계기\" style=\"position:relative;\"><a href=\"#%EC%B9%B4%ED%94%84%EC%B9%B4%EB%A5%BC-%EC%95%8C%EA%B2%8C-%EB%90%9C-%EA%B3%84%EA%B8%B0\" aria-label=\"카프카를 알게 된 계기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>카프카를 알게 된 계기</h2>\n<p>서비스를 분산화 하고, 여러 도메인 서비스에서 발생하는 이벤트를 받아<br>\n분산처리를 할 수 있는 아키텍처를 찾고 있었습니다.<br>\n그럴러면, 마이크로 서비스들이 서로 서로 이벤트를 받아야 하는데,<br>\n이러한 아키텍처를 구현 할 수 있는 쉽고 강력한 도구가 없을까? 라는 생각을 하게 되었습니다.<br>\n그러던중, 카프카라는 강력한 플랫폼을 알게 되었고<br>\n알면알수록 매력적으로 다가왔습니다.</p>\n<h2 id=\"위키백과가-말해주는-카프카란\" style=\"position:relative;\"><a href=\"#%EC%9C%84%ED%82%A4%EB%B0%B1%EA%B3%BC%EA%B0%80-%EB%A7%90%ED%95%B4%EC%A3%BC%EB%8A%94-%EC%B9%B4%ED%94%84%EC%B9%B4%EB%9E%80\" aria-label=\"위키백과가 말해주는 카프카란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>위키백과가 말해주는 카프카란?</h2>\n<blockquote>\n<p>아파치 카프카는 아파치 소프트웨어 재단이 스칼라로 개발한 오픈 소스 메시지 브로커 프로젝트이다. 이 프로젝트는 실시간 데이터 피드를 관리하기 위해 통일된, 높은 처리량, 낮은 지연시간을 지닌 플랫폼을 제공하는\n것이 목표이다.<br>\n개발된곳은 링크드인이고, 2011년초 최종적으로 오픈소스화 되었다.</p>\n<blockquote>\n<p>카프카를 사용하는 기업<br>\n애플,카카오 (기업),이베이,넷플릭스,페이팔,Uber,월마트<br>\n(알만한 기업들은 모두 사용!)</p>\n</blockquote>\n</blockquote>\n<h2 id=\"confluent가-말하는-카프카란-confluent는-링크드인-카프카-개발자가-만든-회사\" style=\"position:relative;\"><a href=\"#confluent%EA%B0%80-%EB%A7%90%ED%95%98%EB%8A%94-%EC%B9%B4%ED%94%84%EC%B9%B4%EB%9E%80-confluent%EB%8A%94-%EB%A7%81%ED%81%AC%EB%93%9C%EC%9D%B8-%EC%B9%B4%ED%94%84%EC%B9%B4-%EA%B0%9C%EB%B0%9C%EC%9E%90%EA%B0%80-%EB%A7%8C%EB%93%A0-%ED%9A%8C%EC%82%AC\" aria-label=\"confluent가 말하는 카프카란 confluent는 링크드인 카프카 개발자가 만든 회사 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Confluent가 말하는 카프카란? (Confluent는 링크드인 카프카 개발자가 만든 회사)</h2>\n<blockquote>\n<p>Apache Kafka는 하루에 수조 개의 이벤트를 처리 할 수있는 커뮤니티 분산 이벤트 스트리밍 플랫폼입니다. 처음에는 메시징 큐로 인식 된 Kafka는 분산 커밋 로그의 추상화를 기반으로합니다. 2011 년\nLinkedIn에서 만들고 오픈 소스로 만든 이후 Kafka는 메시징 대기열에서 본격적인 이벤트 스트리밍 플랫폼으로 빠르게 발전했습니다.\n<img data-action=\"zoom\" src=\"{{ &quot;assets/images/kafka-service.png&quot; | relative_url }}\" alt=\"absolute\"></p>\n</blockquote>\n<h2 id=\"쉽게-생각해보기\" style=\"position:relative;\"><a href=\"#%EC%89%BD%EA%B2%8C-%EC%83%9D%EA%B0%81%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"쉽게 생각해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>쉽게 생각해보기</h2>\n<ul>\n<li>Kafka는 실시간 이벤트 기반 애플리케이션 개발을 가능하게하는 오픈 소스 분산 스트리밍 플랫폼이다.</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA20lEQVQoz42S2QqEMAxF+/8f6LPgg4iKuO9mOIHM1KUygZCl6W2SWycBOY5DFdn3XbZtU2tnTzX4zpJPigC0rutJTfDbtpWqqmSaJo3dW4fIsiynvAFi53mWpmkkz/MfIB0QjOP4TV4BGKeua/V5ALURbyMDWBSFxHEsWZYpKC/bxWEY1EZRpH5Zlnpue7U6lNj5C39aPF35nXARQGqx7C9JEum6LrzDK4DPKpeMKB73pyF2IXb93VBs+wPMJ8UfWQHlRQw0lAcQstI0lb7v//s2b3+UjiDRiISUD8gyFL866q3TAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/0257c23d2f1712dff8512fadccbaa0fe/37523/01.png\"\n        srcset=\"/static/0257c23d2f1712dff8512fadccbaa0fe/e9ff0/01.png 180w,\n/static/0257c23d2f1712dff8512fadccbaa0fe/f21e7/01.png 360w,\n/static/0257c23d2f1712dff8512fadccbaa0fe/37523/01.png 720w,\n/static/0257c23d2f1712dff8512fadccbaa0fe/302a4/01.png 1080w,\n/static/0257c23d2f1712dff8512fadccbaa0fe/07a9c/01.png 1440w,\n/static/0257c23d2f1712dff8512fadccbaa0fe/9eaa0/01.png 1676w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\"><em>이해하기 위해 만든 이미지</em></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>이벤트가 발생하면 worker1,worker2,worker3이 어떠한 작업을 수행해야한다.<br>\n위의 그림과 같이 이벤트가 발생하면 카프카 브로커로 메시지를 보내고\nworker1,worker2,worker3는 이벤트에 대해서 감시하고 있다가<br>\n이벤트가 발생하면 해당 작업을 수행합니다.</p>\n<p>예를 들면…\n피자가게를 예를 들어보겠습니다.</p>\n<blockquote>\n<ol>\n<li>홀 직원이 피자,파스타,음료 주문을 받습니다.(이벤트 발생)</li>\n<li>주방으로 주문을 전달합니다. (카프카 브로커 전달)</li>\n<li>주방에서 직원들은 주문알림기계(카프카브로커)를 보고있습니다.</li>\n</ol>\n</blockquote>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  주문이 들어왔다는것을 확인합니다.</code></pre></div>\n<blockquote>\n<blockquote>\n<ol start=\"4\">\n<li>피자제조, 파스타제조, 음료제조를 각자 임무를 수행합니다.</li>\n</ol>\n</blockquote>\n<p>각자의 임무에 대해서 서로에게 지장을 주지 않습니다.<br>\n중요한 부분중 하나라고 생각하는것이 서비스간의 느슨하게 결합이고 생각합니다.<br>\n(이러한 아키텍처를 활용한다면, 마이크로 서비스를 늘리는데에 부담이 줄어 들것같습니다.)</p>\n</blockquote>\n<h2 id=\"카프카에는-어떤-개념들이-있을까\" style=\"position:relative;\"><a href=\"#%EC%B9%B4%ED%94%84%EC%B9%B4%EC%97%90%EB%8A%94-%EC%96%B4%EB%96%A4-%EA%B0%9C%EB%85%90%EB%93%A4%EC%9D%B4-%EC%9E%88%EC%9D%84%EA%B9%8C\" aria-label=\"카프카에는 어떤 개념들이 있을까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>카프카에는 어떤 개념들이 있을까?</h2>\n<hr>\n<p>카프카를 간단하게 아래와 분류해 보았습니다.(간단하게만 적었습니다..)</p>\n<ol>\n<li>Zookeeper\n<ul>\n<li>주키퍼, Kafka cluster node의 상태, Kafka topic, partition 등을 관리합니다.</li>\n</ul>\n</li>\n<li>Broker\n<ul>\n<li>브로커, 프로듀서로 전달 받은 메시지를 저장합니다 and 컨슈머에게 메시지를 전달합니다.</li>\n</ul>\n</li>\n<li>Producer\n<ul>\n<li>프로듀서, 브로커로 메시지를 전달합니다.</li>\n</ul>\n</li>\n<li>Consumer\n<ul>\n<li>컨슈머, 브로커로 부터 토픽(이벤트)를 전달 받습니다.<br>\n브로커가 컨슈머에게 전달하는것은 아니고, 컨슈머가 토픽을 감시하고 있는 형태입니다.</li>\n</ul>\n</li>\n<li>Topic\n<ul>\n<li>토픽, 이벤트라고 보면됩니다.</li>\n</ul>\n</li>\n</ol>\n<p>이외에도 partition,offset,replication factor,consumer group,cluster,Kafka Connect,Kafka Stream 등등 알아 볼것이 많습니다!</p>\n<hr>\n<h4 id=\"참조링크\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EC%A1%B0%EB%A7%81%ED%81%AC\" aria-label=\"참조링크 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;참조링크></h4>\n<p><a href=\"http://kafka.apache.org/\">카프카 웹 사이트</a><br>\n<a href=\"https://dzone.com/articles/real-time-stream-processing-with-apache-kafka-part-1\">real-time-stream-processing-with-apache-kafka-part-1</a></p>","frontmatter":{"date":"December 15, 2020","title":"도대체 카프카란?","categories":"kafka","author":"wooobo","emoji":"🔮"},"fields":{"slug":"/kafka/2020-12-15-what-is-kafka-01/"}},"prev":{"id":"c069517a-ff7e-5068-9c36-aaa779173f59","html":"<h1 id=\"컨슈머-그룹\" style=\"position:relative;\"><a href=\"#%EC%BB%A8%EC%8A%88%EB%A8%B8-%EA%B7%B8%EB%A3%B9\" aria-label=\"컨슈머 그룹 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컨슈머 그룹?</h1>\n<p>지난번 카프카 파티션(<a href=\"/kafka-partition/\">링크</a>) 에 대해서 알아 보았습니다.<br>\n파티션을 만듬으로인해 Producer가 대량으로 토픽을 전송 하였을때,<br>\n토픽을 저장 할 때 병목현상을 해결 할 수 있는 이점을 알 수있었습니다.<br>\n그렇다면, 받는입장(Consumer)에서는 어떨까요?</p>\n<ul>\n<li>시나리오\n<ul>\n<li>이벤트 발생(Producer)이 10대의 서버에서 발생</li>\n<li>Consumer 1대</li>\n</ul>\n</li>\n</ul>\n<p>위 와 같은 상황이라면, 이벤트를 처리하는(consumer) 속도보다<br>\n이벤트를 쌓는(producer)가 더 많을 것으로 예상됩니다.<br>\n그렇다면, 컨슈머 또한 늘려서 해소해야 될것같습니다.<br>\nconsumer group을 활용하여 이벤트를 분산 수행 하는것에 대해알아 보겠습니다.</p>\n<blockquote>\n<p>의문, 컨슈머를 여러대 만들면 되는거 아닌가?<br>\n네, 만약 컨슈머 그룹이 아닌 컨슈머를 여러대 만든다면<br>\n여려대의 컨슈머가 모두 같은 메세지를 받습니다.<br>\n3개의 작업이 대기중일때\n3대의 컨슈머가 있다면 3대 모두 3개의 작업을 진행 할 것입니다.(중복 작업)<br>\n컨슈머 그룹을 활용 한다면 분산하여 작업을 진행 할 수 있습니다.<br>\n컨슈머 그룹에 컨슈머 3대가 있다면 각각 1개 의 작업을 분산하여 진행 하는것을 기대하고 예제를 진행해보겠습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 주키퍼 실행</span>\n$ bin/zookeeper-server-start.sh config/zookeeper.properties\n\n<span class=\"token comment\"># 카프카 실행 </span>\n$ bin/kafka-server-start.sh config/server.properties\n\n$ bin/kafka-topics.sh <span class=\"token parameter variable\">--zookeeper</span> localhost:2181 <span class=\"token parameter variable\">--list</span>\n<span class=\"token operator\">></span> __consumer_offsets\n<span class=\"token operator\">></span> partition-first-topic\n<span class=\"token operator\">></span> quickstart-events\n\n<span class=\"token comment\"># 컨슈머 그룹 실행 (기본적으로 컨슈머 실행 커맨드와 동입합니다. \"--group my-first-group\" 추가 합으로써 그룹이름을 지정해줍니다)</span>\n<span class=\"token comment\"># 터미널 2개를 열어서 각 터미널에 동일하게 2번 실행하겠습니다.</span>\n<span class=\"token comment\"># bin/kafka-console-producer.sh --topic partition-first-topic --bootstrap-server localhost:9092</span>\n<span class=\"token comment\"># producer를 실행하여 빠르게 메시지를 보내시면 2개로 각각 분산되어 빠르게 토픽을 받는것을 확인 하실수 있습니다.</span>\n$ bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 <span class=\"token parameter variable\">--topic</span> partition-first-topic <span class=\"token parameter variable\">--group</span> my-first-group\n$ bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 <span class=\"token parameter variable\">--topic</span> partition-first-topic <span class=\"token parameter variable\">--group</span> my-first-group</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAnklEQVQ4y72SOQrEMAxFlcauvBQm9/CWeMn9r6VBKoZJyALBTPH4GNuS+F/Qe0di27adttZwXVcspezIOWNKifUMiDFiCGEYXHAkMHI6nrDW+vXn6NmZh8uy3AL06enRLxTIHeyh9/4/obwqeHf5KmVaYILCOUKeXS3w5WLP84zOObTWotaa1RjD0FkpxQghUEr5CEzThAAwDuo8suAHWg9/2iwBA9gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/13aa1bef7bd6d7c1a509efe8a5dd107c/37523/consumer-group-producer.png\"\n        srcset=\"/static/13aa1bef7bd6d7c1a509efe8a5dd107c/e9ff0/consumer-group-producer.png 180w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/f21e7/consumer-group-producer.png 360w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/37523/consumer-group-producer.png 720w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/302a4/consumer-group-producer.png 1080w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/07a9c/consumer-group-producer.png 1440w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/78302/consumer-group-producer.png 2798w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>컨슈머에 “my-first-group” 그룹을 지정하여 두개를 실행 하였고,<br>\n메시지가 나뉘어서 들어오는것을 확인 할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># 컨슈머 그룹 리스트 확인하기\n$ bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list\n> my-first-group # 현재 1개의 컨슈머 그룹이 있는것을 확인할수있습니다.\n\n# \"my-first-group\" 해당 컨슈머 그룹에 대한 정보 가져오기\n$ bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group my-first-group\nGROUP           TOPIC                 PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID     HOST            CLIENT-ID\nmy-first-group  partition-first-topic 1          12              13              1               -               -               -\nmy-first-group  partition-first-topic 2          14              15              1               -               -               -\nmy-first-group  partition-first-topic 0          12              13              1               -               -               -\n\n# 위의 정보에 대해서 알아보겠습니다.\n# PARTITION: 파티션 번호\n# CURRENT-OFFSET: 최근 가져온 offset 번호\n# LOG-END-OFFSET: 현재 쌓여져 있는 마지막 offset 번호\n# LAG: 아직 가져오지 못한 토픽 갯수\n# 현재 파티션 3개에 각각 1개씩 LAG가 발생한것을  확인 하실 수 있습니다.\n# 이는 3개의 토픽이 컨슈머가 가져오기 전이라는 뜻입니다.</code></pre></div>\n<table>\n<thead>\n<tr>\n<th align=\"center\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA40lEQVQoz5VS2QqDQAz0/39PEF+8Hrxv8QCvKRPIorTUNhCyu5nM5rLwh5znKXbbNszzbHSaJizLIn5Lgb8qhcG+78PzPIRhCNd1kSQJjuOApaB/ZN93jOOItm2R57lkyExNhmQmiMozS/pmiaOQpK7r22dC2Pc9mqZB13UC+GTLsrxZvjPDNE0xDIPpsRASQEICGEBbVdXtXhSFYNgr3hWfZdk7oZbxVCItP9ABqZ9qCH8ZCgO0LXEcS0XM6hqr58e1oazrKiti2zaCIIDjOIiiyGSuOFPy0yJreboJqle/TvkFkn8NeMMOvN0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/f2a51d6d784db8a6d915b3cbadc4866a/37523/kafka-offset-lag.png\"\n        srcset=\"/static/f2a51d6d784db8a6d915b3cbadc4866a/e9ff0/kafka-offset-lag.png 180w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/f21e7/kafka-offset-lag.png 360w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/37523/kafka-offset-lag.png 720w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/302a4/kafka-offset-lag.png 1080w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/e8814/kafka-offset-lag.png 1392w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\"><em>위 그림은 6까지 가져왔고 마지막 메시지는 8이므로 LAG가 2개 발생 상태입니다.</em></td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th align=\"center\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 519px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQoz42S6Y6DMAyEef/n4y8SApFwhPsoR4tXn6uw3dVu1UhWHMeeGTsJzvOUT4y1LItEUSTHcej5r5xAPlwUANj3vazr+m9OMM+zNE2jScMwyDiOWuT9ruuEHOec2rZtet73XUEej4cqvhRSnOf5xQ4QIN5v21aBIa2qSs9YHMeSpqkYY8Raq8AK6JFZqEQBu/dRArDv4n6/yzRNKiJJEsmyTMqy/FZIG7ChsK5rZSf22/etA+i7wgBjvxS+DhVQil4NNcRRCDDzQilkjIA4/g+FSKeQC9hRw9yI9f3zccbx2TaLUXAXhqF+Iwgvhf6V2NfbTZOdq3Q2kDFwa4wYa8VkRlWjhjzIIcN/+w/naRJjrCa7qpKyKMTVjRRFoQ/07q9+Aeu0BhZx3HuEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/14078c66fc853c24db509ade03d500cf/b23ad/consumer-group.png\"\n        srcset=\"/static/14078c66fc853c24db509ade03d500cf/e9ff0/consumer-group.png 180w,\n/static/14078c66fc853c24db509ade03d500cf/f21e7/consumer-group.png 360w,\n/static/14078c66fc853c24db509ade03d500cf/b23ad/consumer-group.png 519w\"\n        sizes=\"(max-width: 519px) 100vw, 519px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\"><em>출처 <a href=\"https://www.confluent.io/\">https://www.confluent.io/</a></em></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"참조링크\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EC%A1%B0%EB%A7%81%ED%81%AC\" aria-label=\"참조링크 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;참조링크></h4>\n<p><a href=\"https://www.confluent.io/blog/tutorial-getting-started-with-the-new-apache-kafka-0-9-consumer-client/\">tutorial-getting-started-with-the-new-apache-kafka-0-9-consumer-client</a></p>","frontmatter":{"date":"December 22, 2020","title":"도대체 카프카 컨슈머 그룹(consumer group)?","categories":"kafka","author":"wooobo","emoji":"🔮"},"fields":{"slug":"/kafka/2020-12-22-kafka-consumer-group/"}},"site":{"siteMetadata":{"siteUrl":"https://wooobo.github.io","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/kafka/2020-12-21-kafka-partition/","nextSlug":"/kafka/2020-12-15-what-is-kafka-01/","prevSlug":"/kafka/2020-12-22-kafka-consumer-group/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}