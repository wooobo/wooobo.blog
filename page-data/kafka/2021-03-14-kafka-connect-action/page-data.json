{"componentChunkName":"component---src-templates-blog-template-js","path":"/kafka/2021-03-14-kafka-connect-action/","result":{"data":{"cur":{"id":"ce3dcbbe-ba07-50ad-b844-0c5ed99d7ed0","html":"<h1 id=\"kafka-connect를-활용하여-file-source-해보기\" style=\"position:relative;\"><a href=\"#kafka-connect%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%98%EC%97%AC-file-source-%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"kafka connect를 활용하여 file source 해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kafka Connect를 활용하여 File Source 해보기</h1>\n<ol>\n<li>kafka, zookeeper가 실행되어있어야 합니다.(카프가가 없으시다면 공식 홈페이지에서 <a href=\"https://www.apache.org/dyn/closer.cgi?path=/kafka/2.7.0/kafka_2.13-2.7.0.tgz\">다운로드</a>)\n(처음 이시라면 <a href=\"https://kth12.github.io/kafka-quick-start/\">참고</a>)</li>\n<li>kafka/config 폴더를 열어보면 아래의 파일들이 존재합니다.\nconnect-file-sink.properties<br>\nconnect-standalone.properties\n위 파일들을 확용하여 File을 감시해보겠습니다.</li>\n</ol>\n<hr>\n<h3 id=\"configconnect-file-sourceproperties\" style=\"position:relative;\"><a href=\"#configconnect-file-sourceproperties\" aria-label=\"configconnect file sourceproperties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>config/connect-file-source.properties</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">name</span><span class=\"token operator\">=</span>local-file-source\n<span class=\"token assign-left variable\">connector.class</span><span class=\"token operator\">=</span>FileStreamSource\n<span class=\"token assign-left variable\">tasks.max</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\n<span class=\"token assign-left variable\">file</span><span class=\"token operator\">=</span><span class=\"token punctuation\">..</span>/example/source.txt\n<span class=\"token assign-left variable\">topic</span><span class=\"token operator\">=</span>connect-test</code></pre></div>\n<p>위 설정 파일은, connect 이름 / connect 라이브러리(connect class) / Source Topic 이름  등등을 설정 할수 있습니다.</p>\n<h3 id=\"configconnect-standaloneproperties\" style=\"position:relative;\"><a href=\"#configconnect-standaloneproperties\" aria-label=\"configconnect standaloneproperties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>config/connect-standalone.properties</h3>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">bootstrap.servers</span><span class=\"token operator\">=</span>localhost:9092\n<span class=\"token assign-left variable\">key.converter</span><span class=\"token operator\">=</span>org.apache.kafka.connect.json.JsonConverter\n<span class=\"token assign-left variable\">value.converter</span><span class=\"token operator\">=</span>org.apache.kafka.connect.json.JsonConverter\n<span class=\"token assign-left variable\">key.converter.schemas.enable</span><span class=\"token operator\">=</span>true\n<span class=\"token assign-left variable\">value.converter.schemas.enable</span><span class=\"token operator\">=</span>true\n\n<span class=\"token assign-left variable\">offset.storage.file.filename</span><span class=\"token operator\">=</span>/tmp/connect.offsets\n<span class=\"token assign-left variable\">offset.flush.interval.ms</span><span class=\"token operator\">=</span><span class=\"token number\">10000</span></code></pre></div>\n<p>카프카 서버 주소 설정 / Source key, value 타입 지정 / 감시할 파일 이름 등등을 설정 할 수 있습니다.</p>\n<h2 id=\"실행-해보기\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89-%ED%95%B4%EB%B3%B4%EA%B8%B0\" aria-label=\"실행 해보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실행 해보기</h2>\n<p>기본 설정 파일에 대해 알아보았고 실행 예제를 알아보겠습니다.</p>\n<p>실행에 앞서 감시할 파일을 생성하여 줍니다.</p>\n<p>저같은 경우 “source.txt” 라는 파일을 생성해주었습니다.</p>\n<h3 id=\"실행-커맨드\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89-%EC%BB%A4%EB%A7%A8%EB%93%9C\" aria-label=\"실행 커맨드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실행 커맨드</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ bin/connect-standalone.sh config/connect-standalone.properties config/connect-file-source.properties\n\nINFO Kafka startTimeMs: <span class=\"token number\">1615649461180</span> <span class=\"token punctuation\">(</span>org.apache.kafka.common.utils.AppInfoParser:121<span class=\"token punctuation\">)</span>\nINFO <span class=\"token punctuation\">[</span>Producer <span class=\"token assign-left variable\">clientId</span><span class=\"token operator\">=</span>connector-producer-local-file-source-0<span class=\"token punctuation\">]</span> Cluster ID: ovrhH6KaQnOfZ0SseIBV6g <span class=\"token punctuation\">(</span>org.apache.kafka.clients.Metadata:279<span class=\"token punctuation\">)</span>\nINFO WorkerSourceTask<span class=\"token punctuation\">{</span>id<span class=\"token operator\">=</span>local-file-source-0<span class=\"token punctuation\">}</span> Source task finished initialization and start <span class=\"token punctuation\">(</span>org.apache.kafka.connect.runtime.WorkerSourceTask:233<span class=\"token punctuation\">)</span>\nINFO Created connector local-file-source <span class=\"token punctuation\">(</span>org.apache.kafka.connect.cli.ConnectStandalone:112<span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\"># 위 출력 로그처럼 정상적으로 실행이 되었다면 파일을 수정해보겠습니다.</span>\n\n$ <span class=\"token function\">cat</span> <span class=\"token operator\">>></span> source.txt\n\thi\n\thello\n\n<span class=\"token comment\"># 감시 파일(source.txt)에 내용을 입력 하였습니다.</span>\n\n$ bin/kafka-console-consumer.sh <span class=\"token parameter variable\">--topic</span> connect-test --from-beginning  --bootstrap-server localhost:9092\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"schema\"</span>:<span class=\"token punctuation\">{</span><span class=\"token string\">\"type\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"string\"</span>,<span class=\"token string\">\"optional\"</span>:false<span class=\"token punctuation\">}</span>,<span class=\"token string\">\"payload\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"hi\"</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"schema\"</span>:<span class=\"token punctuation\">{</span><span class=\"token string\">\"type\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"string\"</span>,<span class=\"token string\">\"optional\"</span>:false<span class=\"token punctuation\">}</span>,<span class=\"token string\">\"payload\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 파일에서 입력했던 내용들을 컨슘되는것을 확인할 수 있습니다.</span>\n<span class=\"token comment\"># 터미널 창을 하나 더 열어 내용을 추가적으로 넣어서 실시간 동기화 되는지 확인해보겠습니다.</span></code></pre></div>\n<h3 id=\"실행-화면\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89-%ED%99%94%EB%A9%B4\" aria-label=\"실행 화면 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실행 화면</h3>\n<p><img src=\"/100d83b03f60cb767cde16c10db7e29e/kafkaconnectgif.gif\" alt=\"img.png\"></p>\n<hr>\n<h3 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h3>\n<p>가장 간단하게 카프카 커넥트 예제에 대해서 알아 보았습니다.</p>\n<p>카프카 커넥트는 여러 플러그인을 붙여 다양한 데이터 소스를 커넥트 할 수 있습니다.</p>\n<p>예로, debezium 오픈소스 플러그인을 활용하면</p>\n<p>mysql, mongoDB, PostgreSQL,Oracle,SqlServer 등 데이터 베이스를 감시하고 데이터를 Source 할 수 있습니다.</p>","excerpt":"Kafka Connect를 활용하여 File Source 해보기 kafka, zookeeper가 실행되어있어야 합니다.(카프가가 없으시다면 공식 홈페이지에서 다운로드)\n(처음 이시라면 참고) kafka/config 폴더를 열어보면 아래의 파일들이 존재합니다.\nconnect-file-sink.properties connect-standalone.properties\n위 파일들을 확용하여 File을 감시해보겠습니다. config/connect-file-source.properties 위 설정 파일은, connect 이름 / connect 라이브러리(connect class) / Source Topic 이름  등등을 설정 할수 있습니다. config/connect-standalone.properties 카프카 서버 주소 설정 / Source key, value 타입 지정 / 감시할 파일 이름 등등을 설정 할 수 있습니다. 실행 해보기 기본 설정 파일에 대해 알아보았고 실행 예제를 알아보겠…","frontmatter":{"date":"March 14, 2021","title":"Kafka connect File Source 알아보기 & 실행","categories":"kafka","author":"wooobo","emoji":"🔮"},"fields":{"slug":"/kafka/2021-03-14-kafka-connect-action/"}},"next":{"id":"289f9b0f-85d9-5e47-b954-c5987dd3a86e","html":"<h1 id=\"컨슈머-그룹\" style=\"position:relative;\"><a href=\"#%EC%BB%A8%EC%8A%88%EB%A8%B8-%EA%B7%B8%EB%A3%B9\" aria-label=\"컨슈머 그룹 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>컨슈머 그룹?</h1>\n<p>지난번 카프카 파티션(<a href=\"/kafka-partition/\">링크</a>) 에 대해서 알아 보았습니다.<br>\n파티션을 만듬으로인해 Producer가 대량으로 토픽을 전송 하였을때,<br>\n토픽을 저장 할 때 병목현상을 해결 할 수 있는 이점을 알 수있었습니다.<br>\n그렇다면, 받는입장(Consumer)에서는 어떨까요?</p>\n<ul>\n<li>시나리오\n<ul>\n<li>이벤트 발생(Producer)이 10대의 서버에서 발생</li>\n<li>Consumer 1대</li>\n</ul>\n</li>\n</ul>\n<p>위 와 같은 상황이라면, 이벤트를 처리하는(consumer) 속도보다<br>\n이벤트를 쌓는(producer)가 더 많을 것으로 예상됩니다.<br>\n그렇다면, 컨슈머 또한 늘려서 해소해야 될것같습니다.<br>\nconsumer group을 활용하여 이벤트를 분산 수행 하는것에 대해알아 보겠습니다.</p>\n<blockquote>\n<p>의문, 컨슈머를 여러대 만들면 되는거 아닌가?<br>\n네, 만약 컨슈머 그룹이 아닌 컨슈머를 여러대 만든다면<br>\n여려대의 컨슈머가 모두 같은 메세지를 받습니다.<br>\n3개의 작업이 대기중일때\n3대의 컨슈머가 있다면 3대 모두 3개의 작업을 진행 할 것입니다.(중복 작업)<br>\n컨슈머 그룹을 활용 한다면 분산하여 작업을 진행 할 수 있습니다.<br>\n컨슈머 그룹에 컨슈머 3대가 있다면 각각 1개 의 작업을 분산하여 진행 하는것을 기대하고 예제를 진행해보겠습니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># 주키퍼 실행</span>\n$ bin/zookeeper-server-start.sh config/zookeeper.properties\n\n<span class=\"token comment\"># 카프카 실행 </span>\n$ bin/kafka-server-start.sh config/server.properties\n\n$ bin/kafka-topics.sh <span class=\"token parameter variable\">--zookeeper</span> localhost:2181 <span class=\"token parameter variable\">--list</span>\n<span class=\"token operator\">></span> __consumer_offsets\n<span class=\"token operator\">></span> partition-first-topic\n<span class=\"token operator\">></span> quickstart-events\n\n<span class=\"token comment\"># 컨슈머 그룹 실행 (기본적으로 컨슈머 실행 커맨드와 동입합니다. \"--group my-first-group\" 추가 합으로써 그룹이름을 지정해줍니다)</span>\n<span class=\"token comment\"># 터미널 2개를 열어서 각 터미널에 동일하게 2번 실행하겠습니다.</span>\n<span class=\"token comment\"># bin/kafka-console-producer.sh --topic partition-first-topic --bootstrap-server localhost:9092</span>\n<span class=\"token comment\"># producer를 실행하여 빠르게 메시지를 보내시면 2개로 각각 분산되어 빠르게 토픽을 받는것을 확인 하실수 있습니다.</span>\n$ bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 <span class=\"token parameter variable\">--topic</span> partition-first-topic <span class=\"token parameter variable\">--group</span> my-first-group\n$ bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 <span class=\"token parameter variable\">--topic</span> partition-first-topic <span class=\"token parameter variable\">--group</span> my-first-group</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAnklEQVQ4y72SOQrEMAxFlcauvBQm9/CWeMn9r6VBKoZJyALBTPH4GNuS+F/Qe0di27adttZwXVcspezIOWNKifUMiDFiCGEYXHAkMHI6nrDW+vXn6NmZh8uy3AL06enRLxTIHeyh9/4/obwqeHf5KmVaYILCOUKeXS3w5WLP84zOObTWotaa1RjD0FkpxQghUEr5CEzThAAwDuo8suAHWg9/2iwBA9gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/13aa1bef7bd6d7c1a509efe8a5dd107c/37523/consumer-group-producer.png\"\n        srcset=\"/static/13aa1bef7bd6d7c1a509efe8a5dd107c/e9ff0/consumer-group-producer.png 180w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/f21e7/consumer-group-producer.png 360w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/37523/consumer-group-producer.png 720w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/302a4/consumer-group-producer.png 1080w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/07a9c/consumer-group-producer.png 1440w,\n/static/13aa1bef7bd6d7c1a509efe8a5dd107c/78302/consumer-group-producer.png 2798w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>컨슈머에 “my-first-group” 그룹을 지정하여 두개를 실행 하였고,<br>\n메시지가 나뉘어서 들어오는것을 확인 할 수 있습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># 컨슈머 그룹 리스트 확인하기\n$ bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --list\n> my-first-group # 현재 1개의 컨슈머 그룹이 있는것을 확인할수있습니다.\n\n# \"my-first-group\" 해당 컨슈머 그룹에 대한 정보 가져오기\n$ bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group my-first-group\nGROUP           TOPIC                 PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID     HOST            CLIENT-ID\nmy-first-group  partition-first-topic 1          12              13              1               -               -               -\nmy-first-group  partition-first-topic 2          14              15              1               -               -               -\nmy-first-group  partition-first-topic 0          12              13              1               -               -               -\n\n# 위의 정보에 대해서 알아보겠습니다.\n# PARTITION: 파티션 번호\n# CURRENT-OFFSET: 최근 가져온 offset 번호\n# LOG-END-OFFSET: 현재 쌓여져 있는 마지막 offset 번호\n# LAG: 아직 가져오지 못한 토픽 갯수\n# 현재 파티션 3개에 각각 1개씩 LAG가 발생한것을  확인 하실 수 있습니다.\n# 이는 3개의 토픽이 컨슈머가 가져오기 전이라는 뜻입니다.</code></pre></div>\n<table>\n<thead>\n<tr>\n<th align=\"center\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA40lEQVQoz5VS2QqDQAz0/39PEF+8Hrxv8QCvKRPIorTUNhCyu5nM5rLwh5znKXbbNszzbHSaJizLIn5Lgb8qhcG+78PzPIRhCNd1kSQJjuOApaB/ZN93jOOItm2R57lkyExNhmQmiMozS/pmiaOQpK7r22dC2Pc9mqZB13UC+GTLsrxZvjPDNE0xDIPpsRASQEICGEBbVdXtXhSFYNgr3hWfZdk7oZbxVCItP9ABqZ9qCH8ZCgO0LXEcS0XM6hqr58e1oazrKiti2zaCIIDjOIiiyGSuOFPy0yJreboJqle/TvkFkn8NeMMOvN0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/f2a51d6d784db8a6d915b3cbadc4866a/37523/kafka-offset-lag.png\"\n        srcset=\"/static/f2a51d6d784db8a6d915b3cbadc4866a/e9ff0/kafka-offset-lag.png 180w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/f21e7/kafka-offset-lag.png 360w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/37523/kafka-offset-lag.png 720w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/302a4/kafka-offset-lag.png 1080w,\n/static/f2a51d6d784db8a6d915b3cbadc4866a/e8814/kafka-offset-lag.png 1392w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\"><em>위 그림은 6까지 가져왔고 마지막 메시지는 8이므로 LAG가 2개 발생 상태입니다.</em></td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th align=\"center\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 519px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQoz42S6Y6DMAyEef/n4y8SApFwhPsoR4tXn6uw3dVu1UhWHMeeGTsJzvOUT4y1LItEUSTHcej5r5xAPlwUANj3vazr+m9OMM+zNE2jScMwyDiOWuT9ruuEHOec2rZtet73XUEej4cqvhRSnOf5xQ4QIN5v21aBIa2qSs9YHMeSpqkYY8Raq8AK6JFZqEQBu/dRArDv4n6/yzRNKiJJEsmyTMqy/FZIG7ChsK5rZSf22/etA+i7wgBjvxS+DhVQil4NNcRRCDDzQilkjIA4/g+FSKeQC9hRw9yI9f3zccbx2TaLUXAXhqF+Iwgvhf6V2NfbTZOdq3Q2kDFwa4wYa8VkRlWjhjzIIcN/+w/naRJjrCa7qpKyKMTVjRRFoQ/07q9+Aeu0BhZx3HuEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/14078c66fc853c24db509ade03d500cf/b23ad/consumer-group.png\"\n        srcset=\"/static/14078c66fc853c24db509ade03d500cf/e9ff0/consumer-group.png 180w,\n/static/14078c66fc853c24db509ade03d500cf/f21e7/consumer-group.png 360w,\n/static/14078c66fc853c24db509ade03d500cf/b23ad/consumer-group.png 519w\"\n        sizes=\"(max-width: 519px) 100vw, 519px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\"><em>출처 <a href=\"https://www.confluent.io/\">https://www.confluent.io/</a></em></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"참조링크\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EC%A1%B0%EB%A7%81%ED%81%AC\" aria-label=\"참조링크 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>&#x3C;참조링크></h4>\n<p><a href=\"https://www.confluent.io/blog/tutorial-getting-started-with-the-new-apache-kafka-0-9-consumer-client/\">tutorial-getting-started-with-the-new-apache-kafka-0-9-consumer-client</a></p>","frontmatter":{"date":"December 22, 2020","title":"도대체 카프카 컨슈머 그룹(consumer group)?","categories":"kafka","author":"wooobo","emoji":"🔮"},"fields":{"slug":"/kafka/2020-12-22-kafka-consumer-group/"}},"prev":{"id":"a3e91a99-4439-5cc0-9a13-d8ce8a1433e0","html":"<h1 id=\"solid-원칙---srp-단일-책임-원칙\" style=\"position:relative;\"><a href=\"#solid-%EC%9B%90%EC%B9%99---srp-%EB%8B%A8%EC%9D%BC-%EC%B1%85%EC%9E%84-%EC%9B%90%EC%B9%99\" aria-label=\"solid 원칙   srp 단일 책임 원칙 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SOLID 원칙 - SRP (단일 책임 원칙)</h1>\n<p>한 클래스는 하나의 책임만 가져야 한다.<br>\n클래스는 그 책임을 완전히 캡슐화해야 함을 일컫는다.<br>\n클래스가 제공하는 모든 기능은 이 책임과 주의 깊게 부합해야 한다.</p>\n<blockquote>\n<p>로버트 마틴은 책임을 변경하려는 이유로 정의하고, 어떤 클래스나 모듈은 변경하려는 단 하나 이유만을 가져야 한다고 결론 짓는다. <br>\n예를 들어서 보고서를 편집하고 출력하는 모듈을 생각해 보자. 이 모듈은 두 가지 이유로 변경될 수 있다. <br>\n첫 번째로 보고서의 내용 때문에 변경될 수 있다. 두 번째로 보고서의 형식 때문에 변경될 수 있다. <br>\n이 두 가지 변경은 하나는 실질적이고 다른 하나는 꾸미기 위한 매우 다른 원인에 기인한다. <br>\n단일 책임 원칙에 의하면 이 문제의 두 측면이 실제로 분리된 두 책임 때문이며, 따라서 분리된 클래스나 모듈로 나누어야 한다.<br>\n다른 시기에 다른 이유로 변경되어야 하는 두 가지를 묶는 것은 나쁜 설계일 수 있다.<br></p>\n</blockquote>\n<h2 id=\"알아보기\" style=\"position:relative;\"><a href=\"#%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0\" aria-label=\"알아보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>알아보기</h2>\n<p>회원정보가 있다. 회원 정보에는 name,email 을 가진다.\nname 은 문자열이고, email 은 Email 형식을 가져야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 169px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.37278106508876%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACWElEQVQ4y41UC0/bQAzO//8dGwIGYpMG4hEqxqtdCbR0iL4oyYVcXr282rSMlvab7BIm1qHtJMfn85eL/dmO5jgOHh4eYNsCQghYlsWahHyFn8VxIKWzhLNtG6ZpMlZrtjuo1H5gMBzi8fER4/F4oUcjuK6EUhH6SiGKYyjVh+8HL5gx6wKf5zm63S401/MQxhmW1wybm5vYWF3B2qctrK5vYH19BVufv+C9RZFqlOrT009kWbYkaZohSRKWKIoQxzHSNF0SwpKv1WpBo4eU8pWL+/t7CLHgpNPpsCa+CFNwSkLYgl/yEeb6+hqa50oO97ZRw9ftHZydH+PsvAJHutjTD3Gi72Nndw89y8K/FgWl+b7PRpbE8DyPyY+Uwmg85jQHWQrLMiFdj3HT6RTPz8+YTCasyZ7NZmxTNloYhn/9GgH+XMXLJMWeLi1svlA6DuYAysclbO8eQD/Yhn50AmHeYe3jB+zqR9g/1GGa4v8i9L1FKqHvIexHkI7NejqdgPiN0wzdbgd+0H/bVLPZG3s+n3NhNKok8egHAcIwQBCErF3XBdERBnQWMMbhSZGvFS/2hKWqNxoNaHQrdTn10nA4RJom3FNs5zkGgwGUUkjSlP2ELfqSNGFJE6bZbEILAw9xpHhsyuen2D/QUSod4eamgUrlO06/lXDbuoMlBIxqBeVyFSpO3p8UIaxFlzebqF0ZuDAM1Gp15s24uMClUUW9cQNL2KhfGbi8qiOktspzjpZkNBpxJu12my78/WchLpiblwkgW0qXq1dMBJ0Rvtfr8XkxSYX9C+T3Wfnq7Mh+AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/5ce51100963b5804262dc55b45413945/d23e3/solid-s-uml01.png\"\n        srcset=\"/static/5ce51100963b5804262dc55b45413945/d23e3/solid-s-uml01.png 169w\"\n        sizes=\"(max-width: 169px) 100vw, 169px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Account</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InvalidParameterException</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Account</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> email<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">Account</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> email<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">validEmail</span><span class=\"token punctuation\">(</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>email <span class=\"token operator\">=</span> email<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">validEmail</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> email<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> ePattern <span class=\"token operator\">=</span> <span class=\"token string\">\"^[a-zA-Z0-9.!#$%&amp;'*+/=?^_`{|}~-]+@((\\\\[[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\])|(([a-zA-Z\\\\-0-9]+\\\\.)+[a-zA-Z]{2,}))$\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>regex<span class=\"token punctuation\">.</span></span>Pattern</span> p <span class=\"token operator\">=</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>regex<span class=\"token punctuation\">.</span></span>Pattern</span><span class=\"token punctuation\">.</span><span class=\"token function\">compile</span><span class=\"token punctuation\">(</span>ePattern<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>regex<span class=\"token punctuation\">.</span></span>Matcher</span> m <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">matcher</span><span class=\"token punctuation\">(</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">.</span><span class=\"token function\">matches</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>m<span class=\"token punctuation\">.</span><span class=\"token function\">matches</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InvalidParameterException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"이메일 형식이 아닙니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>Account 는 회원정보를 담는 객체이다. 하지만, validEmail() 의 이메일 검증 행동이 추가 되었다.<br>\n그렇다면 Account 객체가 이메일 검증 행동과 관계가 있는가?<br>\nAccount 정보는 email 이라는 문자열(String) 타입을 가지고있다. String 은 문자열 일뿐 Email 포맷을 증명하지 못한다.<br>\n그래서 그것을 증명하기 위해 validEmail() 메소드가 추가 되었다. Account 는 스스로 email 포맷까지 증명하고 있다는 것이다.<br>\n생각해보면 <em>email</em> 과 <em>validEmail()</em> 은 관계성을 가진다. <em>validEmail()</em> 에 의해 통과 되어야 email 을 가질 수 있는것이다.<br>\n그렇다면 Email 이라는 타입을 정의하고 스스로 이메일을 검증한다면 단일 책임 원칙을 가지는게 아닐까?<br>\n그리고 Account 는 Email 객체를 가진다면, 단일 책임을 행할 수 있는게 아닐까?</p>\n<hr>\n<p>다음은 Account 와 Email 사이의 책임을 분리시켜보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 496px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA50lEQVQY012Q2W6EMAxF+f+fK+08ANMOUAYwEPZdbLe6llqpE8mJ41gnJ7FSEbRdD2MKvNk2PM/DMAxomgbTNOE8TxzH8S/qpsUwjJinCWEYwphSe6uqgsUpjmP4vo/H4wvjOGJdV4UyJ3Df9z8Y95JlSNMUWSaw7XcYY7AsC0QEVtu2apMXOYrCgOO6LoWWZangruvQ973mvPw7DJGJIEkStWIvg2Arz3MEgQ/HcRAEAaLnUwF1XSvg1ZB1gth/u33AdV3c75+gGOtqKJIiiiIt8E9pQyif8fqHtN+2Tc9o9bsy5nnGD7Lte2TLsWVgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/57ee7cbeda6a589e9f19cdade1e74571/bb630/solid-s-uml02.png\"\n        srcset=\"/static/57ee7cbeda6a589e9f19cdade1e74571/e9ff0/solid-s-uml02.png 180w,\n/static/57ee7cbeda6a589e9f19cdade1e74571/f21e7/solid-s-uml02.png 360w,\n/static/57ee7cbeda6a589e9f19cdade1e74571/bb630/solid-s-uml02.png 496w\"\n        sizes=\"(max-width: 496px) 100vw, 496px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>Account</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InvalidParameterException</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Account</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Email</span> email<span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">Account</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Email</span> email<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>email <span class=\"token operator\">=</span> email<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">return</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">Email</span> <span class=\"token function\">getEmail</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> email<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<ul>\n<li>Email</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>security<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InvalidParameterException</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Email</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> email<span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">Email</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> email<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">validEmail</span><span class=\"token punctuation\">(</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>email <span class=\"token operator\">=</span> email<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">validEmail</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> email<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> ePattern <span class=\"token operator\">=</span> <span class=\"token string\">\"^[a-zA-Z0-9.!#$%&amp;'*+/=?^_`{|}~-]+@((\\\\[[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\])|(([a-zA-Z\\\\-0-9]+\\\\.)+[a-zA-Z]{2,}))$\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>regex<span class=\"token punctuation\">.</span></span>Pattern</span> p <span class=\"token operator\">=</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>regex<span class=\"token punctuation\">.</span></span>Pattern</span><span class=\"token punctuation\">.</span><span class=\"token function\">compile</span><span class=\"token punctuation\">(</span>ePattern<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>regex<span class=\"token punctuation\">.</span></span>Matcher</span> m <span class=\"token operator\">=</span> p<span class=\"token punctuation\">.</span><span class=\"token function\">matcher</span><span class=\"token punctuation\">(</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">.</span><span class=\"token function\">matches</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>m<span class=\"token punctuation\">.</span><span class=\"token function\">matches</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InvalidParameterException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"이메일 형식이 아닙니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>이제 Account 는 Email 객체를 가지게 되어 이메일 검증을 통과된 Email 타입 객체를 가질 수 있게 되었다.<br>\n추후 Email 검증 로직이 변경 되더라도, Account 는 이메일 검증로직 변화에 좀 더 자유로워 질 수 있다.<br>\n하지만, Account 는 스스로 완전한 상태가 아닌 Email 과의 관계성이 추가되었다.</p>\n<hr>\n<h2 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p>처음에는 혼란스러웠다. 단일 책임이라…\nAccount 와 Email 을 굳이 분리를 해야하나…라는 생각이었다.<br>\n확실히 분리 하고보니 코드의 안정감이 생겼다.\n이게 맞다 틀리다라고 생각하기 보단 객체 지향 관점에서 사고 할려고 노력하는게 맞는것 같다.<br>\n무조건 저렇게 해야되 라기 보단 어떻게 보면 방법론이니까 그것을 지향하는 쪽으로 사고 훈련을 해야 될 것 같다.</p>\n<h3 id=\"참고링크\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EB%A7%81%ED%81%AC\" aria-label=\"참고링크 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고링크</h3>\n<p><a href=\"https://ko.wikipedia.org/wiki/SOLID_(%EA%B0%9D%EC%B2%B4_%EC%A7%80%ED%96%A5_%EC%84%A4%EA%B3%84)\">SOLID 객체지향 설계 위키백과</a></p>","frontmatter":{"date":"October 16, 2021","title":"SOLID 원칙(1) - 단일 책임 원칙 알아보기 (SRP)","categories":"프로그래밍","author":"wooobo","emoji":"🔮"},"fields":{"slug":"/solid/2021-10-16-SOLID-SRP/"}},"site":{"siteMetadata":{"siteUrl":"https://wooobo.github.io","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/kafka/2021-03-14-kafka-connect-action/","nextSlug":"/kafka/2020-12-22-kafka-consumer-group/","prevSlug":"/solid/2021-10-16-SOLID-SRP/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}